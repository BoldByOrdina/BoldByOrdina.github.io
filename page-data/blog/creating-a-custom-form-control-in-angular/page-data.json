{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/creating-a-custom-form-control-in-angular/","result":{"data":{"site":{"siteMetadata":{"title":"Ordina Bold Tech & Design Blog","configs":{"countOfInitialPost":10}}},"markdownRemark":{"id":"bfa11ea8-4c20-5537-b7f0-a9ce63544f6b","excerpt":"A part of good application architecture is using the correct tools for the job.\nWith forms in Angular, this means knowing when to use Template Driven Forms vs. Reactive Forms.\nIn short, this depends mostly on the size of your form.\nA simple login screen may use Template Driven…","html":"<p>A part of good application architecture is using the correct tools for the job.\nWith forms in Angular, this means knowing when to use Template Driven Forms vs. Reactive Forms.\nIn short, this depends mostly on the size of your form.\nA simple login screen may use Template Driven Forms, whereas a more advanced web form should use Reactive Forms.\nThese forms consist of FormGroups and FormControls, keeping the form value organised.</p>\n<p>By default, Angular already allows to bind a HTMLInputElement or HTMLSelectElement to a control using the FormControl and FormControlName (in combination with FormGroup) directives.\nThis is enough for most forms, but sometimes there is a need for something more specialised, for example a date picker or a slider.\nThere are numerous packages on npm providing these and most component libraries also include the most common controls for your development pleasure.\nBut sometimes you can’t find the correct package to match your needs.\nI still see many developers use a default text input field, and parsing the value after the form is submitted.\nObviously there is a better way and I’ll describe it below.</p>\n<h2 id=\"case-study\" style=\"position:relative;\"><a href=\"#case-study\" aria-label=\"case study permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Case study</h2>\n<p>As a case study, I’ve chosen to create a color picker.\nThis picker should not have any traditional input control, but instead display the selected color in a rounded circle.\nClicking on the control should open a color picker and allow the user to edit the value.\nThe control should be part of a FormGroup, so that Validators can be added.</p>\n<p>For those interested, the full code of this article is available at <a href=\"https://stackblitz.com/edit/custom-control-color-picker\">StackBlitz</a>.</p>\n<h2 id=\"the-color-picker\" style=\"position:relative;\"><a href=\"#the-color-picker\" aria-label=\"the color picker permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The color picker</h2>\n<p>Let’s start with creating a color picker.\nBecause developers shouldn’t do everything themselves, I opted to reuse an existing color-picker dependency.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 606px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.05128205128205%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVQoz42S2W7FIAxE+f//q6qqL63aBJNLVrKwJVMNUa66Sa2lEztgj5FBreuKcRwxDMMday24Ttv3/U9oIQRs2wblnEPXdYW+74unIJswgYkpJcQYf3Cts/k8z8WraZruJ7tiblKQ4kz6LsQmn2nbtsBY8cNCiuWc4b0/xd1URMdpLCJcZw4bHMfxhcsYK/7GlBFDBI5zZoxzygWKleT9KDGbXsW/oUI3o3kSyOuA6tmiNRPMSw/nVoQ9IOYInzxCCviPqWAMqscHVFYgVlDfNOqmhraCN3mHvgnqRhfP2RJe5LIsxROOgfD0yocALQLRAiMGs3Pn7frzGfjNF09YRCFy3Szja5+CHybhbNMst9xFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Search results for &#39;npm i want a color picker&#39;\"\n        title=\"I just took the first one I came across.\"\n        src=\"/static/c663b1899fcff15c3975add509dd88fb/4d4a2/1ra016d24o.png\"\n        srcset=\"/static/c663b1899fcff15c3975add509dd88fb/cb9a0/1ra016d24o.png 195w,\n/static/c663b1899fcff15c3975add509dd88fb/727ba/1ra016d24o.png 390w,\n/static/c663b1899fcff15c3975add509dd88fb/4d4a2/1ra016d24o.png 606w\"\n        sizes=\"(max-width: 606px) 100vw, 606px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>I just took the first one I came across.</p></figcaption>\n  </figure></p>\n<p>To challenge myself, I tried to look for a control picker with as little helping functions as possible.\nThe only thing I wanted from it, is to show it on demand, hide it on demand and get/set the value.\nLuckily my first pick was just that.\nNo TypeScript, no open/close status, nothing fancy.</p>\n<p>This is what it can do:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">AColorPicker<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>eventName<span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span>eventName<span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The possible events are “change”, “coloradd” and “colorremove”.\nThe last two are supposed to help with a color palette, but that’s out of scope, which leaves the only event being “change”.</p>\n<h2 id=\"creating-a-color-picker-component\" style=\"position:relative;\"><a href=\"#creating-a-color-picker-component\" aria-label=\"creating a color picker component permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating a color picker component</h2>\n<p>As a rule of thumb, a component that will be used as a control should be a dumb component.\nI mostly set the template and style inline for dumb components to keep them from growing too big.</p>\n<p>This is the eventual code of the component.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AfterViewInit<span class=\"token punctuation\">,</span> ChangeDetectionStrategy<span class=\"token punctuation\">,</span> ChangeDetectorRef<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> OnDestroy<span class=\"token punctuation\">,</span> ViewChild<span class=\"token punctuation\">,</span> ElementRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> AColorPicker <span class=\"token keyword\">from</span> <span class=\"token string\">'a-color-picker'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token operator\">:</span> <span class=\"token string\">'my-color-picker'</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;div class=\"picker-icon\" [class.disabled]=\"isDisabled\" style=\"background: {% raw %}{{ color }}{% endraw %}\" (click)=\"openPicker()\">&lt;/div>\n    &lt;div #pickerElement class=\"picker\" acp-show-rgb=\"no\"\n     acp-show-hsl=\"no\"\n     acp-show-hex=\"no\">\n      &lt;button *ngIf=\"open\" type=\"button\" (click)=\"closePicker()\">close&lt;/button>\n    &lt;/div>\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  styles<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    .picker {\n      display: flex;\n      flex-direction: column-reverse;\n      position: absolute;\n    }\n\n    .picker-icon {\n      width: 1em;\n      height: 1em;\n      margin: 2px 0;\n      border: 2px solid white;\n      box-sizing: border-box;\n      box-shadow: 0 0 1px 1px gray;\n      border-radius: 50%;\n    }\n\n    .picker-icon.disabled {\n      opacity: 0.5;\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  changeDetection<span class=\"token operator\">:</span> ChangeDetectionStrategy<span class=\"token punctuation\">.</span>OnPush\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ColorPickerComponent</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AfterViewInit</span><span class=\"token punctuation\">,</span> OnDestroy <span class=\"token punctuation\">{</span>\n\n  open <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  color <span class=\"token operator\">=</span> <span class=\"token string\">'#fff000'</span><span class=\"token punctuation\">;</span>\n  isDisabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> _picker <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">get</span> <span class=\"token function\">picker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_picker <span class=\"token operator\">?</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_picker<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">ViewChild</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'pickerElement'</span><span class=\"token punctuation\">)</span> pickerElement<span class=\"token operator\">:</span> ElementRef<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> changeDetectorRef<span class=\"token operator\">:</span> ChangeDetectorRef\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">ngAfterViewInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">initializePicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">addChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token function\">ngOnDestroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">openPicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isDisabled<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">closePicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">initializePicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pickerElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_picker <span class=\"token operator\">=</span> AColorPicker<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pickerElement<span class=\"token punctuation\">.</span>nativeElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Picker could not be initialized'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">addChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_picker<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>changeDetectorRef<span class=\"token punctuation\">.</span><span class=\"token function\">markForCheck</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">removeChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_picker<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This component can now display the color picker, by clicking the icon.\nIt can also be closed by clicking the close button that’s added to the picker.\nI like to keep <code class=\"language-text\">ChangeDetection.OnPush</code> on dumb components, but that means that I need to inject the <code class=\"language-text\">ChangeDetectorRef</code> to update the color while the picker is being used.\nWithout the <code class=\"language-text\">markForCheck</code>, the color would only be updated when the picker is closed.</p>\n<p><img src=\"/4f1834d2fc53a5f71374088f5d242f1f/9wh3d54f1b.gif\" alt=\"A demonstration of the picker.\" title=\"It&#x27;s working! It&#x27;s working!\"></p>\n<h2 id=\"making-a-control-out-of-it\" style=\"position:relative;\"><a href=\"#making-a-control-out-of-it\" aria-label=\"making a control out of it permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Making a control out of it</h2>\n<p>Now comes the interesting part.\nI want to be able to use <code class=\"language-text\">my-color-picker</code> with the <code class=\"language-text\">formControl</code> and <code class=\"language-text\">formControlName</code> directives.\nIf you’d just use these directives, you’d get the error “No value accessor for form control with name: &#x3C;the name of your control>“.\nSimply put, this means that the control does not know what to bind to.\nSo we start by implementing the <code class=\"language-text\">ControlValueAccessor</code> interface from <code class=\"language-text\">@angular/forms</code> into the component.\nThis interface has three functions that need to be implemented and one optional function.</p>\n<ul>\n<li>writeValue(obj: any): void</li>\n<li>registerOnChange(fn: any): void</li>\n<li>registerOnTouched(fn: any): void</li>\n<li>setDisabledState?(isDisabled: boolean): void</li>\n</ul>\n<p>The function <code class=\"language-text\">setDisabledState</code> is optional, but also the easiest to understand.\nIt’s triggered by the <code class=\"language-text\">formControl.enable()</code> and <code class=\"language-text\">formControl.disable()</code> functions.\nThe other functions may be a bit more difficult to understand.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">setDisabledState</span><span class=\"token punctuation\">(</span>isDisabled<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isDisabled <span class=\"token operator\">=</span> isDisabled<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isDisabled<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">closePicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>changeDetectorRef<span class=\"token punctuation\">.</span><span class=\"token function\">markForCheck</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The function <code class=\"language-text\">writeValue</code> is called every time <code class=\"language-text\">formControl.setValue(obj)</code> or <code class=\"language-text\">formControl.patchValue(obj)</code> is called.\nThe type of obj is by default <code class=\"language-text\">any</code>, because ReactiveForms are still not strongly typed.\nYou can for example call <code class=\"language-text\">numberControl.setValue('not a number')</code> and your application will build correctly.\nEven at runtime you’d probably not get an error, but that doesn’t mean this is a valid value.\nThat’s why there are validators.\nIt’s best to parse this value to something understandable for your component.\nIn this case, the color will be a string containing either the hexadecimal value like <code class=\"language-text\">#ff0000</code> or a word like <code class=\"language-text\">red</code>.\nThe <code class=\"language-text\">a-color-picker</code>-package luckily allows all string values and will convert to a hexadecimal value that matches.\nA downside of this package is that it has to be bound after view init.\nHowever <code class=\"language-text\">writeValue</code> will be called before <code class=\"language-text\">ngAfterViewInit</code>, so the initial form value might not be set correctly.\nThat is why the value is also stored in <code class=\"language-text\">color</code>, which is used to set the initial value when the picker is initialized.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">writeValue</span><span class=\"token punctuation\">(</span>obj<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>obj<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>obj<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The functions <code class=\"language-text\">registerOnChange</code> and <code class=\"language-text\">registerTouched</code> are used to set a callback function when the control’s value changes or when it’s being touched without a change.\nThese callbacks can be called whenever you want in your component and they are usually the <code class=\"language-text\">setValue</code> and <code class=\"language-text\">markAsTouched</code> properties.\nThey are usually implemented like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">_onChange</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>color<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token function-variable function\">_onTouched</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">registerOnChange</span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">fn</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>color<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onChange <span class=\"token operator\">=</span> fn<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">registerOnTouched</span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">fn</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_onTouched <span class=\"token operator\">=</span> fn<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We’ll be using them in our change event, like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">closePicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>picker<span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_onTouched</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token function\">addChangeListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_picker<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>changeDetectorRef<span class=\"token punctuation\">.</span><span class=\"token function\">markForCheck</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_onChange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If we test the control now, we’ll still get the error “No value accessor for form control with name: &#x3C;the name of your control>“.\nThe reason is that, even though we implemented our component as a ControlValueAccessor, we still didn’t specify that the control should bind to it.\nThere are two ways to do this.\nThe easiest way is to provide the component as a value accessor, by adding the following to the component’s decorator:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>     \n  <span class=\"token punctuation\">{</span>\n    provide<span class=\"token operator\">:</span> <span class=\"token constant\">NG_VALUE_ACCESSOR</span><span class=\"token punctuation\">,</span>\n    useExisting<span class=\"token operator\">:</span> <span class=\"token function\">forwardRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ColorPickerComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    multi<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>The injection token <code class=\"language-text\">NG_VALUE_ACCESSOR</code> can be imported from <code class=\"language-text\">@angular/forms</code> and <code class=\"language-text\">forwardRef</code> can be imported from <code class=\"language-text\">@angular/core</code>.\nSimply put, the function <code class=\"language-text\">forwardRef</code> allows the dependency injector to refer to a reference that hasn’t been defined yet.</p>\n<p>Now we have a fully functioning color picker control.</p>\n<h2 id=\"validating-the-control-value\" style=\"position:relative;\"><a href=\"#validating-the-control-value\" aria-label=\"validating the control value permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Validating the control value</h2>\n<p>Validating a control with a custom ControlValueAccessor works exactly the same as validating any other FormControl.\nYou can have synchronous and asynchronous validators.</p>\n<p>An evident example is the <code class=\"language-text\">required</code> validator.\nSomething more specific might be a validator to have at least 50% blue in the color:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">myForm <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  bgColor<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>Validators<span class=\"token punctuation\">.</span>required<span class=\"token punctuation\">,</span> ValidateMinimumBlue<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  fgColor<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> Validators<span class=\"token punctuation\">.</span>required<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ValidateMinimumBlue</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>control<span class=\"token operator\">:</span> FormControl<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>control<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> b <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">parseColor</span><span class=\"token punctuation\">(</span>control<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> b <span class=\"token operator\">>=</span> <span class=\"token number\">128</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> minimumBlue<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>error<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>myForm.get(<span class=\"token punctuation\">'</span>fgColor<span class=\"token punctuation\">'</span>).hasError(<span class=\"token punctuation\">'</span>minimumBlue<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Not blue enough<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><img src=\"/ed42aabbd0b7d00b8e7ac5f2867e3f78/warqsmdbk7.gif\" alt=\"A demonstration of the picker validation.\" title=\"I like the color blue, ok.\"></p>\n<p>Another example is a contrast validator on the form group itself:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">myForm <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  bgColor<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>Validators<span class=\"token punctuation\">.</span>required<span class=\"token punctuation\">,</span> ValidateMinimumBlue<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  fgColor<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> Validators<span class=\"token punctuation\">.</span>required<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>validators<span class=\"token operator\">:</span> <span class=\"token function\">ValidateContrast</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fgColor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bgColor'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ValidateContrast</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>leftControlName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> rightControlName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>formGroup<span class=\"token operator\">:</span> FormGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> leftControl <span class=\"token operator\">=</span> formGroup<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>leftControlName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rightControl <span class=\"token operator\">=</span> formGroup<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>rightControlName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token operator\">...</span>\n  <span class=\"token keyword\">return</span> contrast <span class=\"token operator\">></span> <span class=\"token constant\">WCAG_2_0_AA</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> contrast<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> contrast<span class=\"token punctuation\">,</span> expected<span class=\"token operator\">:</span> <span class=\"token constant\">WCAG_2_0_AA</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"styling-invalid-and-touched-controls\" style=\"position:relative;\"><a href=\"#styling-invalid-and-touched-controls\" aria-label=\"styling invalid and touched controls permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Styling invalid and touched controls</h2>\n<p>Most of the time you want a visual indication that a control is valid or invalid.\nYou can do this using css in your component like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:host.ng-touched .picker-icon</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">:host.ng-touched .picker-icon:after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>100%<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> \n\n<span class=\"token selector\">:host.ng-touched.ng-invalid .picker-icon</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 0 0 1px 1px darkred<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">:host.ng-touched.ng-invalid .picker-icon:after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>   \n\n<span class=\"token selector\">:host.ng-touched.ng-valid .picker-icon</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 0 0 1px 1px green<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">:host.ng-touched.ng-valid .picker-icon:after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'✅'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"/53fee15beff475ed3199a85dde1bf5c3/xnk6yxgsdr.gif\" alt=\"A demonstration of the indication that the control is valid.\"></p>\n<h2 id=\"reacting-on-more-behavior\" style=\"position:relative;\"><a href=\"#reacting-on-more-behavior\" aria-label=\"reacting on more behavior permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reacting on more behavior</h2>\n<p>If you want to your code to react on more control behaviour, like <code class=\"language-text\">statusChanges</code>, you cannot do this out of the box with <code class=\"language-text\">NG_VALUE_ACCESSOR</code>.\nHowever, you can inject <code class=\"language-text\">NgControl</code> from <code class=\"language-text\">@angular/forms</code> instead.\nAngular uses this instance to represent the control within the object graph that has been created for the form.</p>\n<p>To use this, you have to remove the provider for <code class=\"language-text\">NG_VALUE_ACCESSOR</code> and instead add this in your constructor:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>ngControl<span class=\"token operator\">:</span> NgControl<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span>ngControl<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ngControl<span class=\"token punctuation\">.</span>valueAccessor <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then you can do things like this in <code class=\"language-text\">ngAfterViewInit</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ngControl<span class=\"token punctuation\">.</span>statusChanges<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function\">takeUntil</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_destroyed$<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>status <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'The current status of the control is'</span><span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Or if you really want to hook onto specific methods, you can do this:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ngControl<span class=\"token punctuation\">.</span>control<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> markAsDirty <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ngControl<span class=\"token punctuation\">.</span>control<span class=\"token punctuation\">.</span>markAsDirty<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ngControl<span class=\"token punctuation\">.</span>control<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">markAsDirty</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">markAsDirty</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ngControl<span class=\"token punctuation\">.</span>control<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mark as dirty has been called'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>I would not recommend these kind of hooks, but if you do need them, be extra careful for infinite loops and other bugs!</strong></p>","headings":[{"depth":2,"value":"Case study","id":"case-study"},{"depth":2,"value":"The color picker","id":"the-color-picker"},{"depth":2,"value":"Creating a color picker component","id":"creating-a-color-picker-component"},{"depth":2,"value":"Making a control out of it","id":"making-a-control-out-of-it"},{"depth":2,"value":"Validating the control value","id":"validating-the-control-value"},{"depth":2,"value":"Styling invalid and touched controls","id":"styling-invalid-and-touched-controls"},{"depth":2,"value":"Reacting on more behavior","id":"reacting-on-more-behavior"}],"frontmatter":{"title":"Creating a custom form control in Angular","category":"Angular","tags":["Angular"],"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/47eb4071e7b4fd828591dc6a4727299b/7b488/qyt3dcd64l.png","srcSet":"/static/47eb4071e7b4fd828591dc6a4727299b/7b488/qyt3dcd64l.png 500w","sizes":"100vw"},"sources":[{"srcSet":"/static/47eb4071e7b4fd828591dc6a4727299b/19135/qyt3dcd64l.webp 500w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.586}}},"authors":[],"date":"August 15, 2020"}},"allMarkdownRemark":{"edges":[{"node":{"id":"d883dd50-1b04-56fe-bd16-194744e1307d","fields":{"authorIds":null,"slug":"/accessibility-improves-UX-and-business-profit/accessibility-improves-UX-and-business-profit/"},"frontmatter":{"date":"2022-05-17T00:00:00.000Z","title":"How good accessibility improves user experiences & business profit","type":"blog","tags":["Accessibility"],"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAB/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAVHIEZf/xAAbEAABBAMAAAAAAAAAAAAAAAAAAREhMQIDEv/aAAgBAQABBQLJR+Sx43wJX//EABURAQEAAAAAAAAAAAAAAAAAABAx/9oACAEDAQE/AYf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARITH/2gAIAQEABj8CxWauyhH/xAAaEAADAQADAAAAAAAAAAAAAAAAARFBIVGB/9oACAEBAAE/IcG10OSAtKejaJVzg1SIX//aAAwDAQACAAMAAAAQP9//xAAWEQEBAQAAAAAAAAAAAAAAAAABAEH/2gAIAQMBAT8QTEBt/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAh/9oACAECAQE/EDTZW//EABwQAQEAAgMBAQAAAAAAAAAAAAERACExQaFxkf/aAAgBAQABPxBh7GHeYTNo65PtyRAH6xzLgNS5oGKN8w7O1L65/9k="},"images":{"fallback":{"src":"/static/b6f4e68d2043a4226b8e448a5df7f044/585d0/daniel-ali-ju1yFZkrxVg-unsplash.jpg","srcSet":"/static/b6f4e68d2043a4226b8e448a5df7f044/05435/daniel-ali-ju1yFZkrxVg-unsplash.jpg 750w,\n/static/b6f4e68d2043a4226b8e448a5df7f044/81c74/daniel-ali-ju1yFZkrxVg-unsplash.jpg 1080w,\n/static/b6f4e68d2043a4226b8e448a5df7f044/b2594/daniel-ali-ju1yFZkrxVg-unsplash.jpg 1366w,\n/static/b6f4e68d2043a4226b8e448a5df7f044/585d0/daniel-ali-ju1yFZkrxVg-unsplash.jpg 1448w","sizes":"100vw"},"sources":[{"srcSet":"/static/b6f4e68d2043a4226b8e448a5df7f044/15f20/daniel-ali-ju1yFZkrxVg-unsplash.webp 750w,\n/static/b6f4e68d2043a4226b8e448a5df7f044/9a568/daniel-ali-ju1yFZkrxVg-unsplash.webp 1080w,\n/static/b6f4e68d2043a4226b8e448a5df7f044/e2fc4/daniel-ali-ju1yFZkrxVg-unsplash.webp 1366w,\n/static/b6f4e68d2043a4226b8e448a5df7f044/73e27/daniel-ali-ju1yFZkrxVg-unsplash.webp 1448w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6691988950276243}}},"authors":null}}},{"node":{"id":"bfa11ea8-4c20-5537-b7f0-a9ce63544f6b","fields":{"authorIds":["orjan_de_smet"],"slug":"/angular-custom-control/angular-custom-control/"},"frontmatter":{"date":"2020-08-15T00:00:00.000Z","title":"Creating a custom form control in Angular","type":"blog","tags":["Angular"],"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyUlEQVQoz03KC0hTYQAF4J/IQDFGFoH5QDCzIgV7qKCUhSsbZqOnUWoiiMNMTcSwyErTTCWEUkvDlppGL8WG6Zybrm3u6Zy67e6O3e3uvubchiaa0ryhEvhxOHDgAOo/kqSIjTgo0uUklhcIzxxJkNRWTtK1dQKCIHBivRwk5pnDPC7cOUtCltmeYff4JOWcxXF880JSpMNMaDffmwBmt2G43Y5hetgxrHA193pyGzwJBXPgNHG3wbLoxhAritptFOYW2l73aetx1IHaUfsGYLLOSXXubr7nGXc2pwY7Vwwfz9ZFXpH7Jo4k542hGIRaCRxxD1lrm8avzUwZUNSOIIh1A+BLbe97jTWtmuLnksz7AhaHF5v+JeJ8JyOuJfRkR7uwosuQ1QuXVskOSxVCFMFg2GQ2w+uBzYDb/bOuqa+06lNGUXv5iz5WdvOh5OqwhMcB0WU7wgvbuD8ax1IKRkGv6A1ipmYgyGiEDJBJbzIbIROormsuefDydn7NxYyKs1fLjzGLwmNzA6OyAg6kg13MytoOg2GC2189ZbDaBR8XP1fojLBZNbbUXWZUjgHOnZL0zPwUdk5C8s2o+MsRMReCI5k798VtZxwBwJ/JTIUg0/SkYVJvkH9rn3+Y+Ptd4UrjDfRpqlwsBKxUdtIZVsyJpLCIo4y9+7f5BADg6+O7JyziYNqt66/a2jRqtUqt0igVEr1F0V5Lc4KXCqNFgzzlNARCQkL9/Bl+/ozAoNDY+FNFnLKe1g86tcKJL9OTi14bpZ2Zlstk4+oJPa9nLS8SyYlyZYQuPWKpJKOAzWZXVj7h8foRxEJ7nSSt+bpGjvyhlZ30UoODhlHIivwSiaTamYn6YtOlIN7AoPBtvSVtt/R7F1iY9whlVr6GpM26v9p7o3TLwCrkXKG93lU9BQ+JRcNDfIl0nWBUzBOIxlVqsVzZzxeIJdJ/8/vhYT3hHxQAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/47eb4071e7b4fd828591dc6a4727299b/3b6f5/qyt3dcd64l.png","srcSet":"/static/47eb4071e7b4fd828591dc6a4727299b/3b6f5/qyt3dcd64l.png 500w","sizes":"100vw"},"sources":[{"srcSet":"/static/47eb4071e7b4fd828591dc6a4727299b/b7ca8/qyt3dcd64l.webp 500w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.586}}},"authors":[]}}},{"node":{"id":"a46dec1a-1810-59b6-9a54-4d0dbf056d6e","fields":{"authorIds":["orjan_de_smet"],"slug":"/angular-include-assets-libraries/angular-include-assets-libraries/"},"frontmatter":{"date":"2019-09-13T00:00:00.000Z","title":"Lessons learned on including library assets into Angular applications","type":"blog","tags":["Angular","Builders","Assets","Library","Monorepo"],"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAED/9oADAMBAAIQAxAAAAHRK6oMYz//xAAYEAADAQEAAAAAAAAAAAAAAAABAhARIf/aAAgBAQABBQI8UFtyKoWf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQIQ/9oACAEDAQE/AYqQRM//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8BNX//xAAaEAACAgMAAAAAAAAAAAAAAAABEAARAkGh/9oACAEBAAY/AiZje+OwF//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExQVH/2gAIAQEAAT8hfoBA4yblbS0vFRpBb2Wz/9oADAMBAAIAAwAAABD3L//EABgRAAIDAAAAAAAAAAAAAAAAAAABESFB/9oACAEDAQE/EJKDwo//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EBoRu3//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMWGRcf/aAAgBAQABPxBwtQg8MCFglqiw8rnuI9/G5bkxypZVdqV8izrP/9k="},"images":{"fallback":{"src":"/static/db2bc63b7c104af4e01d98f84cf1f448/5cc6d/tpryd.jpg","srcSet":"/static/db2bc63b7c104af4e01d98f84cf1f448/5cc6d/tpryd.jpg 500w","sizes":"100vw"},"sources":[{"srcSet":"/static/db2bc63b7c104af4e01d98f84cf1f448/b7ca8/tpryd.webp 500w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.586}}},"authors":[]}}},{"node":{"id":"8fc38192-40d5-5e5e-8eeb-58da83d2e469","fields":{"authorIds":null,"slug":"/being-productive-with-typescript/being-productive-with-typescript/"},"frontmatter":{"date":"2022-06-08T00:00:00.000Z","title":"Being productive with Typescript","type":"blog","tags":["Typescript","Best practices"],"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAA//aAAwDAQACEAMQAAABznU7xiAf/8QAGRAAAgMBAAAAAAAAAAAAAAAAAQIAERIQ/9oACAEBAAEFAkAJZRqXU0ef/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAACEBIDH/2gAIAQEABj8CeCmv/8QAGBABAAMBAAAAAAAAAAAAAAAAAQAQEXH/2gAIAQEAAT8hyMhIDOUJaRSv/9oADAMBAAIAAwAAABB7/wD/xAAXEQEAAwAAAAAAAAAAAAAAAAABEBEh/9oACAEDAQE/EA24/8QAFhEBAQEAAAAAAAAAAAAAAAAAERAh/9oACAECAQE/EHCf/8QAHBAAAgICAwAAAAAAAAAAAAAAAREAIRBRMZGx/9oACAEBAAE/EH9SWdQ4sJQIIun7WHIsdGciQHqlj//Z"},"images":{"fallback":{"src":"/static/0ef7c409e0c579c3893684bfac9eb1a7/e0c47/banner.jpg","srcSet":"/static/0ef7c409e0c579c3893684bfac9eb1a7/19708/banner.jpg 750w,\n/static/0ef7c409e0c579c3893684bfac9eb1a7/e0c47/banner.jpg 1000w","sizes":"100vw"},"sources":[{"srcSet":"/static/0ef7c409e0c579c3893684bfac9eb1a7/c0046/banner.webp 750w,\n/static/0ef7c409e0c579c3893684bfac9eb1a7/c2b28/banner.webp 1000w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.586}}},"authors":null}}},{"node":{"id":"f8129530-ed91-5c32-8a14-06dd0f8775b7","fields":{"authorIds":[],"slug":"/designing-the-design-process/designing-the-design-process/"},"frontmatter":{"date":"2019-12-23T00:00:00.000Z","title":"Designing the design process","type":"blog","tags":["Design process"],"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABIklEQVQY032RzU7DMBCE8/5vxQ0JqQcqKlEJSqH5aYhrZx3ba3t3jWIIJ8Qny9qDx6uZacqG1MMVYc4sNguLlL8glhhTQ0SrsgoKcxFhoiJsHb5fwYVYCotw/XlbU2HmBhz6RCFxSIxZHFLMnIkDZgPOY8okmdjHhJnnBdtBafA+ErE0x8HdHcan3u275bG19y+30+R6HZRLnQ4jYK9Dd/P7C+w+YPc2r48H93CGwabGIvXGGySb5Qr+8NqOECDyHMkgzZGmBVsFytjzpU85r9FsDhoISfsMSMZnE/KMZCMDEqzDekMkTwUxGQPMUqRUw6vtZlJWGz9OYGY/qeXSKYzpN5UfeI1dasjEsjUjzXdJsQo+lX4+nlJK5V+U5rZnM/MXPUvPVJjy2+cAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/267f0a920cea0607f3e61217bc86b013/d2a4e/1_0efMr1b_peoGJtTjTFK7Gg.png","srcSet":"/static/267f0a920cea0607f3e61217bc86b013/2de81/1_0efMr1b_peoGJtTjTFK7Gg.png 750w,\n/static/267f0a920cea0607f3e61217bc86b013/d2a4e/1_0efMr1b_peoGJtTjTFK7Gg.png 939w","sizes":"100vw"},"sources":[{"srcSet":"/static/267f0a920cea0607f3e61217bc86b013/adb52/1_0efMr1b_peoGJtTjTFK7Gg.webp 750w,\n/static/267f0a920cea0607f3e61217bc86b013/c3e93/1_0efMr1b_peoGJtTjTFK7Gg.webp 939w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.40149094781682637}}},"authors":[]}}}]}},"pageContext":{"slug":"/angular-custom-control/angular-custom-control/"}},"staticQueryHashes":["1274017682"]}